
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© ØµØ§Ù„Ø© Ø§Ù„Ø¨Ù„ÙŠØ§Ø±Ø¯Ùˆ ÙˆØ§Ù„Ø¨Ù„Ø§ÙŠØ³ØªÙŠØ´Ù†</title>
<script type="module">
import { initializeApp, getApp, getApps } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import { getDatabase, ref, onChildAdded } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

// Ø¥Ø¹Ø¯Ø§Ø¯ Firebase
const firebaseConfig = {
  apiKey: "AIzaSyC9Y_FW-ULjOD5F7U-WBV7aBMNvEyKAhfg",
  authDomain: "billiard-system.firebaseapp.com",
  databaseURL: "https://billiard-system-default-rtdb.firebaseio.com/",
  projectId: "billiard-system",
  storageBucket: "billiard-system.appspot.com",
  messagingSenderId: "152994605455",
  appId: "1:152994605455:web:1a668b2cd713b11a9cc612"
};

// Ù…Ù†Ø¹ Ø§Ù„Ø®Ø·Ø£ ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…ÙƒØ±Ø±Ø©
let app;
if (!getApps().length) {
  app = initializeApp(firebaseConfig);
} else {
  app = getApp();
}

const db = getDatabase(app);

// ØªØªØ¨Ø¹ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯
const tablesRef = ref(db, "registrations");
onChildAdded(tablesRef, (tableSnap) => {
  const tableId = tableSnap.key;
  const playersRef = ref(db, `registrations/${tableId}`);

  onChildAdded(playersRef, (snap) => {
    const data = snap.val();
    if (!data) return;

    console.log("ğŸ“¡ Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯ Ù…Ù† Firebase:");
    console.log("Ø§Ù„Ø§Ø³Ù…:", data.playerName);
    console.log("Ø§Ù„Ù„Ø¹Ø¨Ø©:", data.gameType);
    console.log("Ø§Ù„Ø·Ø§ÙˆÙ„Ø©:", data.tableId);
    console.log("Ø§Ù„Ù†Ù…Ø·:", data.mode);
    console.log("Ø§Ù„Ù…Ø¯Ø©:", data.minutes);
    console.log("Ø§Ù„Ø³Ø¹Ø±:", data.total);

    const msg = `ğŸ± ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ù„Ø§Ø¹Ø¨ Ø¬Ø¯ÙŠØ¯
Ø§Ù„Ø§Ø³Ù…: ${data.playerName}
Ø§Ù„Ù„Ø¹Ø¨Ø©: ${data.gameType}
Ø§Ù„Ù†Ù…Ø·: ${data.mode}
Ø§Ù„Ø·Ø§ÙˆÙ„Ø©: ${data.tableId}
Ø§Ù„Ù…Ø¯Ø©: ${data.minutes} Ø¯Ù‚ÙŠÙ‚Ø©
Ø§Ù„Ø³Ø¹Ø±: ${data.total} Ø¯.Ø¹`;

    // Ø¥Ø´Ø¹Ø§Ø± Ù…Ø±Ø¦ÙŠ Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙØ­Ø©
    const div = document.createElement("div");
    div.style = "background:#111;color:#fff;padding:15px;margin:10px;border-radius:10px;font-family:'Tahoma';";
    div.innerText = msg;
    document.body.appendChild(div);

    // Ù†Ø·Ù‚ ØµÙˆØªÙŠ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
    const utter = new SpeechSynthesisUtterance(`ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù„Ø§Ø¹Ø¨ ${data.playerName} ÙÙŠ Ø·Ø§ÙˆÙ„Ø© ${data.tableId}`);
    utter.lang = "ar";
    speechSynthesis.speak(utter);
  });
});
</script>
</head>
<body style="background-color:#000;color:white;text-align:center;font-family:Tajawal;">
<h2>âœ… Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© ØµØ§Ù„Ø© Ø§Ù„Ø¨Ù„ÙŠØ§Ø±Ø¯Ùˆ ÙˆØ§Ù„Ø¨Ù„Ø§ÙŠØ³ØªÙŠØ´Ù†</h2>
<p>Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…ØµØ­Ø­ - Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Firebase Ù…ÙØ¹Ù‘Ù„Ø©</p>
</body>
</html>
